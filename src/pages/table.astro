---
import DefaultLayout from '@layouts/DefaultLayout.astro';
import { supabase } from 'src/lib/supabase';
import Search from "astro-pagefind/components/Search";

const { data, error } = await supabase
  .from('sites')
  .select()

if (error) {
  console.error(error);
  throw error;
}
---

<script is:inline src="/js/tablesort.min.js"></script>

<DefaultLayout title="List View">
    <div class="container">
        <h1>List View</h1>
        <Search id="search" className="mt-15" uiOptions={{ showImages: false }} />
        <table data-pagefind-body id="listView" class="table-auto mt-10">
            <thead>
                <th class="border border-gray-500">Name</th>
                <th class="border border-gray-500">Description</th>
                <th class="border border-gray-500">Days and Times</th>
                <th class="border border-gray-500">Address</th>
                <th class="border border-gray-500">Zip Code</th>
            </thead>
            <tbody>
                {
                data.map((item) => (
                    <tr>
                        <td class="border border-gray-500 p-3">{item.site_name}</td>
                        <td class="border border-gray-500 p-3">{item.site_description}</td>
                        <td class="border border-gray-500 p-3">{item.site_date_time}</td>
                        <td class="border border-gray-500 p-3">{item.site_address}</td>
                        <td class="border border-gray-500 p-3">{item.site_zip}</td>
                    </tr>
                ))
                }
            </tbody>
        </table>
    </div>
</DefaultLayout>

<script>
  new Tablesort(document.getElementById('listView'));
</script>

<style>
    :root {
        --pagefind-ui-border: #adb5bd;
    }
</style>